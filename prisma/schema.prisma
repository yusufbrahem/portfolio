// Portfolio CMS Database Schema
// SQLite for simplicity and portability

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// ============================================
// SKILLS
// ============================================

model SkillGroup {
  id        String   @id @default(uuid())
  name      String
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  skills    Skill[]

  @@index([order])
}

model Skill {
  id           String     @id @default(uuid())
  skillGroupId String
  name         String
  order         Int       @default(0)
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  skillGroup    SkillGroup @relation(fields: [skillGroupId], references: [id], onDelete: Cascade)

  @@index([skillGroupId, order])
}

// ============================================
// EXPERIENCE
// ============================================

model Experience {
  id        String            @id @default(uuid())
  title     String
  company   String
  location  String
  period    String
  order     Int               @default(0)
  createdAt DateTime          @default(now())
  updatedAt DateTime          @updatedAt
  bullets   ExperienceBullet[]
  tech      ExperienceTech[]

  @@index([order])
}

model ExperienceBullet {
  id           String     @id @default(uuid())
  experienceId String
  text         String
  order         Int       @default(0)
  createdAt     DateTime  @default(now())
  experience   Experience @relation(fields: [experienceId], references: [id], onDelete: Cascade)

  @@index([experienceId, order])
}

model ExperienceTech {
  id           String     @id @default(uuid())
  experienceId String
  name         String
  order         Int       @default(0)
  createdAt     DateTime  @default(now())
  experience   Experience @relation(fields: [experienceId], references: [id], onDelete: Cascade)

  @@index([experienceId, order])
}

// ============================================
// PROJECTS
// ============================================

model Project {
  id        String         @id @default(uuid())
  title     String
  summary   String
  order     Int            @default(0)
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt
  bullets   ProjectBullet[]
  tags      ProjectTag[]

  @@index([order])
}

model ProjectBullet {
  id        String   @id @default(uuid())
  projectId String
  text      String
  order     Int      @default(0)
  createdAt DateTime @default(now())
  project   Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId, order])
}

model ProjectTag {
  id        String   @id @default(uuid())
  projectId String
  name      String
  order     Int      @default(0)
  createdAt DateTime @default(now())
  project   Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId, order])
}

// ============================================
// ABOUT CONTENT
// ============================================

model AboutContent {
  id         String            @id @default(uuid())
  title      String
  paragraphs String            // JSON array stored as string
  createdAt  DateTime          @default(now())
  updatedAt  DateTime          @updatedAt
  principles AboutPrinciple[]
}

model AboutPrinciple {
  id             String        @id @default(uuid())
  aboutContentId String
  title          String
  description    String
  order          Int           @default(0)
  createdAt      DateTime      @default(now())
  aboutContent   AboutContent  @relation(fields: [aboutContentId], references: [id], onDelete: Cascade)

  @@index([aboutContentId, order])
}

// ============================================
// PERSON INFO (Contact)
// ============================================

model PersonInfo {
  id        String   @id @default(uuid())
  name      String
  role      String
  location  String
  email     String
  linkedIn  String
  cvUrl     String?  // URL to CV/Resume PDF file
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// ============================================
// HERO CONTENT
// ============================================

model HeroContent {
  id         String   @id @default(uuid())
  headline   String
  subheadline String
  highlights String   // JSON array stored as string
  createdAt  DateTime @default(now())
  updatedAt DateTime  @updatedAt
}

// ============================================
// ARCHITECTURE CONTENT
// ============================================

model ArchitectureContent {
  id        String              @id @default(uuid())
  createdAt DateTime            @default(now())
  updatedAt DateTime            @updatedAt
  pillars   ArchitecturePillar[]
}

model ArchitecturePillar {
  id                    String              @id @default(uuid())
  architectureContentId String
  title                 String
  order                 Int                 @default(0)
  createdAt             DateTime            @default(now())
  architectureContent   ArchitectureContent @relation(fields: [architectureContentId], references: [id], onDelete: Cascade)
  points                ArchitecturePoint[]

  @@index([architectureContentId, order])
}

model ArchitecturePoint {
  id                    String              @id @default(uuid())
  architecturePillarId String
  text                  String
  order                 Int                 @default(0)
  createdAt             DateTime            @default(now())
  architecturePillar   ArchitecturePillar  @relation(fields: [architecturePillarId], references: [id], onDelete: Cascade)

  @@index([architecturePillarId, order])
}

// ============================================
// ADMIN AUTHENTICATION
// ============================================

model AdminUser {
  id           String   @id @default(uuid())
  username     String   @unique
  passwordHash String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}
